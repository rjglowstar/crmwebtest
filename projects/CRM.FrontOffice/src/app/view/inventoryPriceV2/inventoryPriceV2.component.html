<title>Pricing Request</title>
<!-- #region Pricing Request -->
<section class="pricing-wrap">

  <div class="content_wrap">
    <div class="d-flex">
      <div class="e-left w-100">
        <!--#region Header -->
        <div class="breadcrumb">
          <div class="breadcrumb-left">
            <ul>
              <li class="breadcrumb-item" routerLink="/"><i class="icon-home"></i>Home</li>
              <li class="breadcrumb-item active" aria-current="page">Inventory Pricing New</li>
            </ul>
          </div>
        </div>
        <div class="summarybar bg">
          <div class="summary-left">
            <kendo-buttongroup kendoTooltip position="bottom" *ngIf="isAllSelected || mySelection.length > 0">
              <button kendoButton title="Select All Stone(s)" class="me-1 pt-0 pb-0" style="line-height: 1.8;"
                *ngIf="isAllSelected" (click)="selectAllPricing('checked', true)">
                Select All
              </button>
              <button kendoButton title="DeSelect Stone(s)" class="me-1 pt-0 pb-0" style="line-height: 1.8;"
                *ngIf="mySelection.length > 0" (click)="selectAllPricing('uncheckedAll', true)">
                DeSelect All
              </button>
            </kendo-buttongroup>
            <ul>
              <li>Total Stone(s) : <span>{{priceReqResponse.total}}</span></li>
              <li>Selected Stone(s) : <span>{{mySelection.length}}</span></li>
            </ul>
          </div>
          <div class="summary-right pe-0">
            <kendo-buttongroup kendoTooltip position="bottom">
              <button kendoButton title="Filter Stone" (click)="openSlotFilterDialog()">
                <i class="icon-search"></i>
              </button>
              <button kendoButton #anchorSpecialStones title="Sync Special Stones" (click)="syncInvSpecialStones()">
                <i class="icon-clear"></i>
              </button>
              <button kendoButton #anchorSummary title="Summry" (click)="openSummary()">
                <i class="icon-summary"></i>
              </button>
              <button kendoButton *ngIf="systemUserObj.canUnlockPrice" [disabled]="mySelection.length == 0"
                (click)="unlockStone()" title="Unlock Stone"><i class="icon-key"></i>
              </button>
              <button kendoButton #anchorExcel (click)="onExcelToggle()" title="Export Excel"><i
                  class="icon-excelnew "></i>
              </button>
              <button kendoButton [disabled]="mySelection.length == 0" (click)="copyToClipboard()"
                title="Copy To Clipboard"><i class="icon-copy"></i>
              </button>
              <button kendoButton *ngIf="isCanUpdateInvCut" title="update Fancy cut" (click)="openModalToUpdateCut()">
                <i class="icon-editcell"></i>
              </button>
              <button kendoButton title="Color Mark" [disabled]="mySelection.length == 0"
                (click)="openColorMarkDialog()"><i class="icon-appearance"></i></button>
              <button kendoButton title="Add Bulk T. Discount" #anchor (click)="onBulkToggle()"
                [disabled]="mySelection.length == 0"><i class="icon-edit"></i></button>
              <button kendoButton title="Marketsheet Discount" [disabled]="mySelection.length == 0"
                (click)="updateBulkDiscountConfirm('Marketsheet')"><i class="icon-marketsheet-discount"></i></button>
              <button kendoButton title="Apply" [disabled]="mySelection.length == 0" (click)="onApplyChanges()">
                <i class="icon-check"></i>
              </button>
              <button kendoButton title="Show Temp Disc" [disabled]="mySelection.length == 0" (click)="showTempDisc()">
                <i class="icon-memoissue"></i>
              </button>
              <button kendoButton title="Grid Configuration" (click)="openGridConfigDialog()">
                <i class="icon-gridconfig"></i>
              </button>
            </kendo-buttongroup>
            <kendo-popup [anchor]="$any(anchor)" #popup *ngIf="showBulk">
              <div class="content p-2">
                <div class="mb-2">
                  <label class="k-label"><strong>Bulk T. Discount</strong></label>
                </div>
                <div class="form-data pop">
                  <input type="text" name="bulkDisc" class="w-100" [(ngModel)]="bulkDisc"
                    (keypress)="utilityService.discountfloat($event)" />
                </div>
                <div class="col-md-12">
                  <div class="text-center px-1">
                    <button class="btn btn-primary mt-1" [disabled]="bulkDisc == null"
                      (click)="updateBulkDiscountManual()">Apply Price Disc.</button>
                  </div>
                </div>
              </div>
            </kendo-popup>
            <kendo-popup [anchor]="$any(anchorExcel)" #popupExcel (anchorViewportLeave)="showExcelOption = false"
              *ngIf="showExcelOption">
              <div class="content p-2 pb-0">

                <div class="mb-2">
                  <input type="radio" name="excelOption" value="searched" #searched [(ngModel)]="excelOption"
                    kendoRadioButton id="searched" />
                  <label class="k-label" class="ms-2 cursor" for="searched">Searched Stone</label>
                </div>
                <div class="mb-2">
                  <input type="radio" name="excelOption" value="selected" #selected [(ngModel)]="excelOption"
                    kendoRadioButton id="selected" />
                  <label class="k-label" class="ms-2 cursor" for="selected">Selected Stone</label>
                </div>

                <div class="col-md-12">
                  <div class="text-center px-2 pb-2">
                    <button class="btn btn-primary w-100" [disabled]="excelOption == null"
                      (click)="exportToExcel('export')">
                      <i class="icon-excelnew"></i> Export to Excel
                    </button>
                    <button class="btn btn-primary w-100 mt-1" [disabled]="excelOption == null"
                      (click)="exportToExcel('csv')">
                      <i class="icon-excelnew"></i> Export to CSV
                    </button>
                    <!-- <button class="btn btn-primary w-100 mt-1" [disabled]="excelOption == null"
                            (click)="exportToExcel('mail')">
                            <i class="icon-icon_email"></i> Send Mail
                          </button> -->
                  </div>
                </div>

              </div>
            </kendo-popup>
          </div>
        </div>
        <!--#endregion -->
        <!--#region Grid -->
        <div class="content_box">
          <div class="grid-wrap pricing-grid">
            <kendo-grid #priceGrid class="price-grid" [data]="gridView!" [reorderable]="true" [resizable]="true"
              [groupable]="true" [sortable]="true" [selectable]="selectableSettings" (sortChange)="sortChange($event)"
              (selectionChange)="selectedRowChange($event)" [group]="groups" (groupChange)="groupChange($event)"
              [pageSize]="pageSize" [skip]="skip" (cellClick)="cellClickHandler($event)"[sort]="sort"
              (cellClose)="cellCloseHandler($event)" [pageable]="true" (pageChange)="pageChange($event)"
              [(selectedKeys)]="mySelection" [kendoGridSelectBy]="'stoneId'" [rowClass]="rowCss"
              (detailExpand)="expandPricingHistory($event)" (detailCollapse)="clearPricingHistory($event)">
              <ng-container *ngIf="fields && fields.length > 0">
                <ng-container *ngFor="let field of fields">
                  <ng-container *ngIf="field.isSelected">
                    <kendo-grid-column [width]="field.width" [editor]="field.editor!" [field]="field.propertyName"
                      [title]="field.title">
                      <ng-template *ngIf="isShowCheckBoxAll && field.title == 'Checkbox'" kendoGridHeaderTemplate>
                        <input kendoGridSelectAllCheckbox type="checkbox" class="k-checkbox" id="headerCheckbox"
                          (selectAllChange)="selectAllPricing($event, false)" />
                        <label class="k-checkbox-label" for="headerCheckbox"></label>
                      </ng-template>
                      <ng-template kendoGridCellTemplate let-dataItem let-rowIndex="rowIndex"
                        *ngIf="field.title == 'Checkbox'">
                        <input *ngIf="!dataItem.isDisabled" type="checkbox" class="k-checkbox"
                          id="checkbox-{{rowIndex}}" [kendoGridSelectionCheckbox]="rowIndex" />
                        <label class="k-checkbox-label" for="checkbox-{{rowIndex}}">
                        </label>
                      </ng-template>
                      <ng-template kendoGridCellTemplate let-dataItem *ngIf="field.title == 'Analytic'">
                        <span class="gr-icon" (click)="openAnalyticsDialog(dataItem)">
                          <i class="icon-analytics"></i>
                          <!-- <i class="icon-diamond"></i> -->
                        </span>
                      </ng-template>
                      <ng-template kendoGridCellTemplate let-dataItem *ngIf="field.title == 'Media'">
                        <div
                          *ngIf="dataItem.media.isHtmlVideo || dataItem.media.isPrimaryImage || dataItem.media.isCertificate">
                          <span class="gr-icon" *ngIf="dataItem.media.isHtmlVideo"
                            (click)="openMediaDialog('360 Vision View', dataItem.stoneId, 'iframe')">
                            <i class="icon-diamond"></i>
                          </span>
                          <span class="gr-icon" *ngIf="dataItem.media.isPrimaryImage"
                            (click)="openMediaDialog('Image View', dataItem.stoneId, 'img')">
                            <i class="icon-camera"></i>
                          </span>
                          <span class="gr-icon" *ngIf="dataItem.media.isCertificate"
                            (click)="openMediaDialog('Certificate View', dataItem.certificateNo, 'cert')">
                            <i class="icon-cerificate"></i>
                          </span>
                        </div>
                      </ng-template>
                      <ng-template kendoGridCellTemplate let-dataItem *ngIf="field.title == 'StoneId'">
                        <div class="whole-cell" [ngClass]="{ 'grid-highlight': dataItem.isHighLight }">
                          {{dataItem.stoneId}}
                        </div>
                      </ng-template>
                      <ng-template kendoGridCellTemplate let-dataItem *ngIf="field.title == 'Main Disc'">
                        <div class="whole-cell"
                          [ngStyle]="{'background-color': getColorMarkRGB(dataItem.discColorMark, true)}">
                          <b>{{dataItem.price.discount}}</b>
                        </div>
                      </ng-template>
                      <ng-template kendoGridCellTemplate let-dataItem *ngIf="field.title == 'T. Main Disc'">
                        <b [ngClass]="(dataItem.isValid != null && dataItem.isValid == false) ? 'text-danger' : ''">
                          {{dataItem.tempPrice.discount}}
                        </b>
                      </ng-template>
                      <ng-template kendoGridCellTemplate let-dataItem *ngIf="field.title == 'Disc Diff'">
                        <span>{{dataItem.tempPrice.discount ?
                          utilityService.ConvertToFloatWithDecimal(dataItem.tempPrice.discount -
                          dataItem.price.discount) : ''}}</span>
                      </ng-template>
                      <ng-template kendoGridCellTemplate let-dataItem *ngIf="field.title == 'Diameter'">
                        <span>{{dataItem.measurement.length}} - {{dataItem.measurement.width}} x
                          {{dataItem.measurement.height}}</span>
                      </ng-template>
                      <ng-template kendoGridCellTemplate let-dataItem *ngIf="field.title == 'Natts'">
                        <span>{{dataItem.inclusion.sideBlack}} - {{dataItem.inclusion.centerBlack}}</span>
                      </ng-template>
                      <ng-template kendoGridCellTemplate let-dataItem *ngIf="field.title == 'Girdle'">
                        <span>{{dataItem.measurement.minGirdle}} - {{dataItem.measurement.maxGirdle}}</span>
                      </ng-template>
                      <ng-template kendoGridCellTemplate let-dataItem *ngIf="field.title == 'Marketsheet Date'">
                        <span>{{dataItem.marketSheetDate | date: 'dd/MM/yyyy'}}</span>
                      </ng-template>
                      <ng-template kendoGridCellTemplate let-dataItem *ngIf="field.propertyName == 'priceUpdatedAt'">
                        <span>{{dataItem.priceUpdatedAt | date: 'dd/MM/yyyy'}}</span>
                      </ng-template>
                      <ng-template kendoGridCellTemplate let-dataItem *ngIf="field.propertyName == 'holdDate'">
                        <span>{{dataItem.holdDate | date: 'dd/MM/yyyy'}}</span>
                      </ng-template>

                      <ng-template kendoGridCellTemplate let-dataItem let-rowIndex="rowIndex"
                        *ngIf="field.title == 'Hold'">
                        <input type="checkbox" class="k-checkbox" id="checkbox-isHold-{{rowIndex}}"
                          [checked]="dataItem.isHold" [disabled]="true" />
                        <label class="k-checkbox-label" for="checkbox-{{rowIndex}}">
                        </label>
                      </ng-template>
                      <ng-template kendoGridCellTemplate let-dataItem let-rowIndex="rowIndex"
                        *ngIf="field.title == 'Rapnet Hold'">
                        <input type="checkbox" class="k-checkbox" id="checkbox-isRapnetHold-{{rowIndex}}"
                          [checked]="dataItem.isRapnetHold" [disabled]="true" />
                        <label class="k-checkbox-label" for="checkbox-{{rowIndex}}">
                        </label>
                      </ng-template>
                      <ng-template kendoGridCellTemplate let-dataItem let-rowIndex="rowIndex"
                        *ngIf="field.title == 'IsLabReturn'">
                        <input type="checkbox" class="k-checkbox" id="checkbox-isLabReturn-{{rowIndex}}"
                          [checked]="dataItem.isLabReturn" [disabled]="true" />
                        <label class="k-checkbox-label" for="checkbox-{{rowIndex}}">
                        </label>
                      </ng-template>
                      <ng-template kendoGridCellTemplate let-dataItem let-rowIndex="rowIndex"
                        *ngIf="field.title == 'Memo'">
                        <input type="checkbox" class="k-checkbox" id="checkbox-isMemo-{{rowIndex}}"
                          [checked]="dataItem.isMemo" [disabled]="true" />
                        <label class="k-checkbox-label" for="checkbox-{{rowIndex}}">
                        </label>
                      </ng-template>
                      <ng-template kendoGridCellTemplate let-dataItem *ngIf="field.propertyName == 'inclusion.brown'">
                        <div [ngClass]="{'font600': dataItem.inclusion.brown?.toLowerCase() != 'no'}">
                          {{dataItem.inclusion.brown}}
                        </div>
                      </ng-template>
                      <ng-template kendoGridCellTemplate let-dataItem *ngIf="field.propertyName == 'inclusion.green'">
                        <div [ngClass]="{'font600': dataItem.inclusion.green?.toLowerCase() != 'no'}">
                          {{dataItem.inclusion.green}}
                        </div>
                      </ng-template>
                      <ng-template kendoGridCellTemplate let-dataItem *ngIf="field.propertyName == 'inclusion.milky'">
                        <div [ngClass]="{'font600': dataItem.inclusion.milky?.toLowerCase() != 'no'}">
                          {{dataItem.inclusion.milky}}
                        </div>
                      </ng-template>
                      <ng-template kendoGridCellTemplate let-dataItem *ngIf="field.propertyName == 'inclusion.shade'">
                        <div [ngClass]="{'font600': dataItem.inclusion.shade?.toLowerCase() != 'no'}">
                          {{dataItem.inclusion.shade}}
                        </div>
                      </ng-template>
                      <ng-template kendoGridCellTemplate let-dataItem let-rowIndex="rowIndex"
                        *ngIf="field.title == 'Order'">
                        <input type="checkbox" class="k-checkbox" id="checkbox-isDOrder-{{rowIndex}}"
                          [checked]="dataItem.isDOrder" [disabled]="true" />
                        <label class="k-checkbox-label" for="checkbox-{{rowIndex}}">
                        </label>
                      </ng-template>
                      <!-- <ng-template kendoGridCellTemplate let-dataItem *ngIf="field.propertyName == 'availableDays'">
                          {{utilityService.calculateAvailableDateDiff(dataItem.marketSheetDate, dataItem.holdDays, dataItem.isHold == true ? dataItem.holdDate : null)}}
                        </ng-template> -->

                    </kendo-grid-column>
                  </ng-container>
                </ng-container>
              </ng-container>
              <ng-template kendoGridDetailTemplate let-dataItem let-rowIndex="rowIndex">
                <div class="his-grid row d-media-wrap ">
                  <div class="d-media d-details">
                    <kendo-tabstrip>
                      <kendo-tabstrip-tab title="Disc. History" [selected]="true">
                        <ng-template kendoTabContent>
                          <kendo-grid [data]="getlistPricingHistory(dataItem.stoneId)" [resizable]="true"
                            [height]="329">
                            <kendo-grid-column [width]="20" title="Before">
                              <ng-template kendoGridCellTemplate let-dataItem>
                                {{calculateDateDiff(dataItem.createdDate)}}
                              </ng-template>
                            </kendo-grid-column>
                            <kendo-grid-column [width]="40" title="Date">
                              <ng-template kendoGridCellTemplate let-dataItem>
                                {{dataItem.createdDate | date: 'dd-MM-yyyy hh:mm:ss a'}}
                              </ng-template>
                            </kendo-grid-column>
                            <kendo-grid-column [width]="25" field="price.rap" title="Rap">
                            </kendo-grid-column>
                            <kendo-grid-column [width]="20" field="price.discount" title="Discount">
                            </kendo-grid-column>
                            <kendo-grid-column [width]="25" field="price.perCarat" title="$/CT">
                            </kendo-grid-column>
                            <kendo-grid-column [width]="25" field="price.netAmount" title="Net Amount">
                            </kendo-grid-column>
                            <kendo-grid-column [width]="25" field="identity.name" title="User">
                            </kendo-grid-column>
                          </kendo-grid>
                        </ng-template>
                      </kendo-tabstrip-tab>
                      <kendo-tabstrip-tab title="Inclusion">
                        <ng-template kendoTabContent *ngFor="let item of getInventoryItems(dataItem.stoneId)">
                          <div class="content t-details">
                            <ul>
                              <li *ngIf="inclusionConfig.shade && (inclusionData  | typefilter:'shade').length > 0">
                                <span class="l-head">Shade</span>
                                <span class="r-det">: {{item.inclusion.shade}}</span>
                              </li>
                              <li *ngIf="inclusionConfig.brown && (inclusionData  | typefilter:'brown').length > 0">
                                <span class="l-head">Brown</span>
                                <span class="r-det">: {{item.inclusion.brown}}</span>
                              </li>
                              <li *ngIf="inclusionConfig.green && (inclusionData  | typefilter:'green').length > 0">
                                <span class="l-head">Green</span>
                                <span class="r-det">: {{item.inclusion.green}}</span>
                              </li>
                              <li *ngIf="inclusionConfig.milky && (inclusionData  | typefilter:'milky').length > 0">
                                <span class="l-head">Milky</span>
                                <span class="r-det">: {{item.inclusion.milky}}</span>
                              </li>
                              <li
                                *ngIf="inclusionConfig.sideBlack && (inclusionData  | typefilter:'sideBlack').length > 0">
                                <span class="l-head">Side Black</span>
                                <span class="r-det">: {{item.inclusion.sideBlack}}</span>
                              </li>
                              <li
                                *ngIf="inclusionConfig.centerBlack && (inclusionData  | typefilter:'centerSideBlack').length > 0">
                                <span class="l-head">Center Side Black</span>
                                <span class="r-det">: {{item.inclusion.centerSideBlack}}</span>
                              </li>
                              <li
                                *ngIf="inclusionConfig.centerBlack && (inclusionData  | typefilter:'centerBlack').length > 0">
                                <span class="l-head">Center Black</span>
                                <span class="r-det">: {{item.inclusion.centerBlack}}</span>
                              </li>
                              <li
                                *ngIf="inclusionConfig.sideWhite && (inclusionData  | typefilter:'sideWhite').length > 0">
                                <span class="l-head">Side White</span>
                                <span class="r-det">: {{item.inclusion.sideWhite}}</span>
                              </li>
                              <li
                                *ngIf="inclusionConfig.centerSideWhite && (inclusionData  | typefilter:'centerSideWhite').length > 0">
                                <span class="l-head">Center Side White</span>
                                <span class="r-det">: {{item.inclusion.centerSideWhite}}</span>
                              </li>
                              <li
                                *ngIf="inclusionConfig.centerWhite && (inclusionData  | typefilter:'centerWhite').length > 0">
                                <span class="l-head">Center White</span>
                                <span class="r-det">: {{item.inclusion.centerWhite}}</span>
                              </li>
                              <li
                                *ngIf="inclusionConfig.openCrown && (inclusionData  | typefilter:'openCrown').length > 0">
                                <span class="l-head">Open Crown</span>
                                <span class="r-det">: {{item.inclusion.openCrown}}</span>
                              </li>
                              <li
                                *ngIf="inclusionConfig.openTable && (inclusionData  | typefilter:'openTable').length > 0">
                                <span class="l-head">Open Table</span>
                                <span class="r-det">: {{item.inclusion.openTable}}</span>
                              </li>
                              <li
                                *ngIf="inclusionConfig.openPavilion && (inclusionData  | typefilter:'openPavilion').length > 0">
                                <span class="l-head">Open Pavalion</span>
                                <span class="r-det">: {{item.inclusion.openPavilion}}</span>
                              </li>
                              <li
                                *ngIf="inclusionConfig.openGirdle && (inclusionData  | typefilter:'openGirdle').length > 0">
                                <span class="l-head">Open Girdle</span>
                                <span class="r-det">: {{item.inclusion.openGirdle}}</span>
                              </li>
                              <li *ngIf="inclusionConfig.efoc && (inclusionData  | typefilter:'efoc').length > 0">
                                <span class="l-head">EFOC</span>
                                <span class="r-det">: {{item.inclusion.efoc}}</span>
                              </li>
                              <li *ngIf="inclusionConfig.efot && (inclusionData  | typefilter:'efot').length > 0">
                                <span class="l-head">EFOT</span>
                                <span class="r-det">: {{item.inclusion.efot}}</span>
                              </li>
                              <li *ngIf="inclusionConfig.efog && (inclusionData  | typefilter:'efog').length > 0">
                                <span class="l-head">EFOG</span>
                                <span class="r-det">: {{item.inclusion.efog}}</span>
                              </li>
                              <li *ngIf="inclusionConfig.efop && (inclusionData  | typefilter:'efop').length > 0">
                                <span class="l-head">EFOP</span>
                                <span class="r-det">: {{item.inclusion.efop}}</span>
                              </li>
                              <li
                                *ngIf="inclusionConfig.naturalOnTable && (inclusionData  | typefilter:'naturalOnTable').length > 0">
                                <span class="l-head">NOT</span>
                                <span class="r-det">: {{item.inclusion.naturalOnTable}}</span>
                              </li>
                              <li
                                *ngIf="inclusionConfig.naturalOnGirdle && (inclusionData  | typefilter:'naturalOnGirdle').length > 0">
                                <span class="l-head">NOG</span>
                                <span class="r-det">: {{item.inclusion.naturalOnGirdle}}</span>
                              </li>
                              <li
                                *ngIf="inclusionConfig.naturalOnCrown && (inclusionData  | typefilter:'naturalOnCrown').length > 0">
                                <span class="l-head">NOC</span>
                                <span class="r-det">: {{item.inclusion.naturalOnCrown}}</span>
                              </li>
                              <li
                                *ngIf="inclusionConfig.naturalOnPavilion && (inclusionData  | typefilter:'naturalOnPavillion').length > 0">
                                <span class="l-head">NOP</span>
                                <span class="r-det">: {{item.inclusion.naturalOnPavillion}}</span>
                              </li>
                              <li
                                *ngIf="inclusionConfig.girdleCondition && (inclusionData  | typefilter:'girdleCondition').length > 0">
                                <span class="l-head">Grid. Con.</span>
                                <span class="r-det">: {{item.inclusion.girdleCondition}}</span>
                              </li>
                              <li *ngIf="inclusionConfig.culet && (inclusionData  | typefilter:'culet').length > 0">
                                <span class="l-head">Culet</span>
                                <span class="r-det">: {{item.inclusion.culet}}</span>
                              </li>
                              <li *ngIf="inclusionConfig.hna && (inclusionData  | typefilter:'hna').length > 0">
                                <span class="l-head">HNA</span>
                                <span class="r-det">: {{item.inclusion.hna}}</span>
                              </li>
                              <li
                                *ngIf="inclusionConfig.eyeClean && (inclusionData  | typefilter:'eyeClean').length > 0">
                                <span class="l-head">Eye Clean</span>
                                <span class="r-det">: {{item.inclusion.eyeClean}}</span>
                              </li>
                              <li *ngIf="inclusionConfig.ktoS && (inclusionData  | typefilter:'ktoS').length > 0">
                                <span class="l-head">Key To Symbol</span>
                                <span class="r-det">: {{item.inclusion.ktoS}}</span>
                              </li>
                              <li *ngIf="inclusionConfig.bowtie && (inclusionData  | typefilter:'bowtie').length > 0">
                                <span class="l-head">Bowtie</span>
                                <span class="r-det">: {{item.inclusion.bowtie}}</span>
                              </li>
                              <li>
                                <span class="l-head">IGrade</span>
                                <span class="r-det">: {{item.inclusion.iGrade}}</span>
                              </li>
                            </ul>
                          </div>
                        </ng-template>
                      </kendo-tabstrip-tab>
                      <kendo-tabstrip-tab title="Measurement">
                        <ng-template kendoTabContent *ngFor="let item of getInventoryItems(dataItem.stoneId)">
                          <div class="content t-details">
                            <ul>
                              <li *ngIf="measurementConfig.length">
                                <span class="l-head">Length</span>
                                <span class="r-det">: {{item.measurement.length}}</span>
                              </li>
                              <li *ngIf="measurementConfig.width">
                                <span class="l-head">Width</span>
                                <span class="r-det">: {{item.measurement.width}}</span>
                              </li>
                              <li *ngIf="measurementConfig.height">
                                <span class="l-head">Height</span>
                                <span class="r-det">: {{item.measurement.height}}</span>
                              </li>
                              <li *ngIf="measurementConfig.depth">
                                <span class="l-head">Depth</span>
                                <span class="r-det">: {{item.measurement.depth}}</span>
                              </li>
                              <li *ngIf="measurementConfig.table">
                                <span class="l-head">Table</span>
                                <span class="r-det">: {{item.measurement.table}}</span>
                              </li>
                              <li *ngIf="measurementConfig.crownHeight">
                                <span class="l-head">Crown Height</span>
                                <span class="r-det">: {{item.measurement.crownHeight}}</span>
                              </li>
                              <li *ngIf="measurementConfig.crownAngle">
                                <span class="l-head">Crown Angle</span>
                                <span class="r-det">: {{item.measurement.crownAngle}}</span>
                              </li>
                              <li *ngIf="measurementConfig.pavillionAngle">
                                <span class="l-head">Pavilion Angle</span>
                                <span class="r-det">: {{item.measurement.pavilionAngle}}</span>
                              </li>
                              <li *ngIf="measurementConfig.pavillionDepth">
                                <span class="l-head">Pavilion Depth</span>
                                <span class="r-det">: {{item.measurement.pavilionDepth}}</span>
                              </li>
                              <li *ngIf="measurementConfig.girdlePer">
                                <span class="l-head">Girdle%</span>
                                <span class="r-det">: {{item.measurement.girdlePer}}</span>
                              </li>
                              <li
                                *ngIf="measurementConfig.girdle && (measurementData  | typefilter:'girdle').length > 0">
                                <span class="l-head">Min Girdle</span>
                                <span class="r-det">: {{item.measurement.minGirdle}}</span>
                              </li>
                              <li
                                *ngIf="measurementConfig.girdle && (measurementData  | typefilter:'girdle').length > 0">
                                <span class="l-head">Max Girdle</span>
                                <span class="r-det">: {{item.measurement.maxGirdle}}</span>
                              </li>
                              <li *ngIf="measurementConfig.ratio">
                                <span class="l-head">Ratio</span>
                                <span class="r-det">: {{item.measurement.ratio}}</span>
                              </li>
                              <li>
                                <span class="l-head">MGrade</span>
                                <span class="r-det">: {{item.measurement.mGrade}}</span>
                              </li>
                            </ul>
                          </div>
                        </ng-template>
                      </kendo-tabstrip-tab>
                    </kendo-tabstrip>
                  </div>
                  <div class="p-r-7">
                    <div class="d-media">
                      <h6 class="title">Diamond Media</h6>
                      <kendo-tabstrip>
                        <kendo-tabstrip-tab [selected]="true">
                          <ng-template kendoTabTitle>
                            <i class="icon-camera"></i>&nbsp;Image
                          </ng-template>
                          <ng-template kendoTabContent *ngIf="dataItem.media">
                            <div class="content" *ngIf="dataItem.media.isPrimaryImage">
                              <img [src]="setupURL(dataItem.stoneId,'image')" alt="diamond image"
                                class="m-auto d-block">
                            </div>
                            <div class="content" *ngIf="!dataItem.media.isPrimaryImage">
                              <img src="commonAssets/images/image-not-found.jpg" alt="diamond image"
                                class="m-auto d-block">
                            </div>
                          </ng-template>
                        </kendo-tabstrip-tab>
                        <kendo-tabstrip-tab>
                          <ng-template kendoTabTitle>
                            <i class="icon-diamond"></i>&nbsp;360 View
                          </ng-template>
                          <ng-template kendoTabContent *ngIf="dataItem.media">
                            <div class="content" *ngIf="dataItem.media.isHtmlVideo">
                              <iframe [src]="setupURL(dataItem.stoneId,'video')" width="100%" height="288px"
                                style="border: 0;" allow='autoplay'></iframe>
                            </div>
                            <div class="content" *ngIf="!dataItem.media.isHtmlVideo">
                              <img src="commonAssets/images/video-not-found.png" alt="diamond Video"
                                class="m-auto d-block">
                            </div>
                          </ng-template>
                        </kendo-tabstrip-tab>
                        <kendo-tabstrip-tab>
                          <ng-template kendoTabTitle>
                            <i class="icon-cerificate"></i>&nbsp;Cerificate
                          </ng-template>
                          <ng-template kendoTabContent *ngIf="dataItem.media">
                            <div class="content" *ngIf="dataItem.media.isCertificate">
                              <iframe [src]="setupURL(dataItem.certificateNo,'certificate')" width="100%" height="288px"
                                style="border: 0;" allow='autoplay'></iframe>
                            </div>
                            <div class="content" *ngIf="!dataItem.media.isCertificate">
                              <img src="commonAssets/images/certi-not-found.png" alt="Diamond Certificate"
                                class="m-auto d-block">
                            </div>
                          </ng-template>
                        </kendo-tabstrip-tab>
                      </kendo-tabstrip>
                    </div>
                  </div>
                </div>
                <ng-template kendoGridNoRecordsTemplate>
                  <span style="text-align: center;display: block">No Records Found</span>
                </ng-template>
              </ng-template>
            </kendo-grid>
          </div>
        </div>
        <!--#endregion -->
      </div>
      <!-- #region summry -->
      <div class="summary-panel summary-topbar" *ngIf="isSummary">
        <div class="marketsheet-status ps-2 pe-2">
          <div class="sr" *ngIf="!isSummaryLoading">
            <h6>Summary <i class="icon-delete float-end mt-1 me-1" (click)="closeSummary()"></i>
            </h6>
            <div class="summary-panel-grid summary-topbar-grid">

              <div class="sum_group">
                <div class="grid-1">
                  <span>Total Records</span>
                  <button type="button" class="btn t-record">{{summaryData.totalCount}}</button>
                </div>
                <div class="grid-1">
                  <span>Total Weight</span>
                  <button type="button" class="btn t-weight">{{summaryData.totalWeight}}</button>
                </div>
              </div>

              <div class="sum_group">
                <div class="grid-1">
                  <span>Avg Day</span>
                  <button type="button" class="btn onhold">{{summaryData.avgDay}}</button>
                </div>
                <div class="grid-1">
                  <span>Avg Available Day</span>
                  <button type="button" class="btn onhold">{{summaryData.avgAvailableDay}}</button>
                </div>
                <div class="grid-1">
                  <span>iAvg Day</span>
                  <button type="button" class="btn onhold">{{summaryData.iAvgDay}}</button>
                </div>
              </div>

              <div class="sum_group">
                <div class="grid-1">
                  <span>Avg Disc</span>
                  <button type="button" class="btn onhold">{{summaryData.avgDiscount}}</button>
                </div>
                <div class="grid-1">
                  <span>Avg $/CT</span>
                  <button type="button" class="btn avg-ct">{{summaryData.avgPerCarat}}</button>
                </div>
                <div class="grid-1">
                  <span>Net $</span>
                  <button type="button" class="btn onhold">{{summaryData.totalNetAmount}}</button>
                </div>
              </div>

              <div class="sum_group">
                <div class="grid-1">
                  <span>B.Avg Disc</span>
                  <button type="button" class="btn onhold">{{summaryData.avgBaseDiscount}}</button>
                </div>
                <div class="grid-1">
                  <span>B.Avg$/Ct</span>
                  <button type="button" class="btn onhold">{{summaryData.avgBasePerCart}}</button>
                </div>
                <div class="grid-1">
                  <span>B.Net Amount</span>
                  <button type="button" class="btn onhold">{{summaryData.totalBaseNetAmount}}</button>
                </div>
              </div>

              <div class="sum_group">
                <div class="grid-1" [ngClass]="{'is-active-summary':filterReq.invFilter.isRapnetHold}"
                  (click)="filterRapnetHoldChange()">
                  <span>Rapnet Hold</span>
                  <button type="button" class="btn rp-block">{{summaryData.totalRapnetHold}}</button>
                </div>
                <div class="grid-1" [ngClass]="{'is-active-summary':filterReq.invFilter.isHold}"
                  (click)="filterChange('Hold')">
                  <span>Hold</span>
                  <button type="button" class="btn onhold">{{summaryData.totalHold}}</button>
                </div>
                <div class="grid-1" [ngClass]="{'is-active-summary':filterReq.invFilter.isMemo}"
                  (click)="filterChange('Memo')">
                  <span>Memo</span>
                  <button type="button" class="btn onhold">{{summaryData.totalMemo}}</button>
                </div>
                <div class="grid-1" [ngClass]="{'is-active-summary':filterReq.invFilter.isLead}"
                  (click)="filterChange('Lead')">
                  <span>Lead</span>
                  <button type="button" class="btn onhold">{{summaryData.totalLead}}</button>
                </div>
                <div class="grid-1" [ngClass]="{'is-active-summary':filterReq.invFilter.isAvailable}"
                  (click)="filterChange('Available')">
                  <span>Available</span>
                  <button type="button" class="btn onhold">{{summaryData.totalAvailable}}</button>
                </div>
              </div>

              <div class="sum_group">
                <div class="grid-1" *ngFor="let item of summaryData.locationTotals"
                  [ngClass]="{'is-active-summary': filterReq.invFilter.location.indexOf(item.location)>-1 }"
                  (click)="filterLocationChange(item.location)">
                  <span>{{item.location}}</span>
                  <button type="button" class="btn onloc">{{item.totalCount}}</button>
                </div>
              </div>

              <div class="sum_group">
                <div class="grid-1">
                  <span>Total Pending Count</span>
                  <button type="button" class="btn onhold">{{summaryData.totalPendingCount}}</button>
                </div>
                <div class="grid-1">
                  <span>Avg Pending Disc</span>
                  <button type="button" class="btn onhold">{{summaryData.avgPendingDiscount}}</button>
                </div>
              </div>

            </div>
          </div>
          <div class="text-center" *ngIf="isSummaryLoading">
            <img src="commonAssets/images/dialoading.gif" width="80px" alt="loading" />
          </div>
        </div>
      </div>
      <!-- #endregion summry -->
    </div>
  </div>
</section>
<!-- #endregion -->

<!-- #region Bulk Discount Edit Modal -->
<!-- <div class="modal c-modal addemp" tabindex="-1" role="dialog" data-keyboard="false" data-backdrop="static"
    *ngIf="isBulkDisc">
    <form>
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">
                        <i class="icon-inventroy"></i>
                        Bulk Discount
                    </h5>
                    <button type="button" class="close" (click)="closeBulkDiscDialog()">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-xl-12 col-lg-12 col-sm-12 col-xs-12">
                            <div class="i-form bu-disc">
                                <div class="grid">
                                    <div class="form-data">
                                        <input type="text" id="lname">
                                    </div>
                                    <div class="form-data">
                                        <button class="btn btn-primary"><i class="icon-add p-0"></i></button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-primary"><i class="icon-add"></i>New</button>
                    <button class="btn btn-primary"><i class="icon-save"></i>Save</button>
                </div>
            </div>
        </div>
    </form>
</div> -->
<!-- #endregion -->

<!-- #region Analytics Modal -->
<ng-container *ngIf="isAnalytics">
  <app-priceanalytic [selectedPriceReq]="selectedPriceReq" (closeDialog)="closeAnalyticsDialog()"></app-priceanalytic>
</ng-container>
<!-- #endregion -->

<!-- #region Search Filter Modal -->
<ng-container *ngIf="isSlotFilter">
  <app-pricing-inv-filter [skip]="0" [pageSize]="pageSize" [groups]="groups" [selectedSlots]="selectedSlots"
    [isPricing]="false" [inventorySearchCriteriaObj]="inventorySearchCriteriaObj"
    [selectedTypeDNormItems]="selectedBranchDNormItems" (ChildEvent)="onFilterChange($event)"
    (toggle)="isSlotFilter=$event"></app-pricing-inv-filter>
</ng-container>
<!-- #endregion -->

<!-- #region Color Mark Modal -->
<div class="modal c-modal colormark" tabindex="-1" role="dialog" data-keyboard="false" data-backdrop="static" *ngIf="iscolorMark">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">
          <i class="icon-appearance"></i>
          Color Mark
        </h5>
        <button type="button" class="close" (click)="closeColorMarkDialog()">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <div class="mb-4 text-center">
          <span class="ms-2" *ngFor="let item of listColorMarkItems">
            <button kendoButton class="mb-1" [ngClass]="(selectedColorMark == item) ? getColorFromClass(item) : null"
              (click)="markColor(item)">
              {{item}}
            </button>
          </span>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-primary" [disabled]="selectedColorMark.length == 0" (click)="saveColorMark()">
          <i class="icon-save"></i>Save</button>
      </div>
    </div>
  </div>
</div>
<!-- #endregion -->

<!-- #region update cut Modal -->
<div class="modal c-modal cut-modal" tabindex="-1" role="dialog" data-keyboard="false" data-backdrop="static"
  *ngIf="isOpenUpdateCutModal">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">
          Update Fancy Cut
        </h5>
        <button type="button" class="close" (click)="closeUpdateCutDialog()">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <div class="row">
          <div class="col-xl-12 col-lg-12 col-sm-12 col-xs-12 ps-2 pe-2">
            <div class="form-data d-flex align-items-center">
              <input autocomplete="off" type="text" id="stoneTxt" placeholder="Stone ID" #StoneTxtInput name="stoneTxt"
                class="c-wi" (keyup.enter)="onEnterAddStone($event)" [(ngModel)]="filterOrAddText">
              <button type="button" kendoTooltip (click)="loadStoneDetails(filterOrAddText)"
                class="btn btn-primary ms-2" title="Add Or Search Inventory"><i class="icon-search pe-0"></i></button>
            </div>
          </div>

        </div>
        <div class="row">
          <div class="col-xl-12 col-lg-12 col-sm-12 col-xs-12">
            <div class="grid-wrap chk-grid">
              <kendo-grid [data]="gridCutUpdateInventory" class="grid-ui upload-grid" [sortable]="true"
                [pageable]="true" [resizable]="true" [pageSize]="5" [selectable]="selectableSettings">
                <ng-container *ngIf="subFields && subFields.length > 0">
                  <ng-container *ngFor="let field of subFields;let i= index">
                    <ng-container *ngIf="field.isSelected">
                      <kendo-grid-column [width]="field.width" [field]="field.propertyName" [title]="field.title">
                      </kendo-grid-column>
                    </ng-container>
                  </ng-container>
                </ng-container>
              </kendo-grid>
            </div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-primary" [disabled]="searchedStones.length == 0" (click)="updateLatestFancyCut()">
          <i class="icon-save"></i>Save</button>
      </div>
    </div>
  </div>
</div>
<!-- #endregion -->

<!-- #region Media Modal-->
<ng-container *ngIf="isShowMedia">
  <app-media [mediaTitle]="mediaTitle" [mediaSrc]="mediaSrc" [mediaType]="mediaType"
    (closeDialog)="closeMediaDialog($event)"></app-media>
</ng-container>
<!-- #endregion -->

<!-- #region GridConfig Modal -->
<ng-container *ngIf="isGridConfig">
  <app-gridconfiguration [fields]="fields" [pageName]="'InventoryPrice'" [gridName]="'InventoryPriceGrid'"
    [gridConfigId]="gridConfig ? gridConfig.id : undefined" (toggle)="isGridConfig=$event"
    (ChildEvent)="setNewGridConfig($event)">
  </app-gridconfiguration>
</ng-container>
<!-- #endregion -->


<!-- Temp Discount Dialog-->
<div *ngIf="showTempData" class="modal c-modal temp-show" tabindex="-1" role="dialog" data-keyboard="false"
  data-backdrop="static">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id=""><i class="icon-memoissue"></i>Temp Disc Detail</h5>
        <button type="button" class="close" (click)="closeTempshowDialog()">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <div class="row">
          <div class="col-xl-12 col-lg-12 col-sm-12 col-xs-12 rs-labissue">
            <!-- #region Grid -->
            <div class="mod-wrap">
              <div class="grid-wrap">

                <kendo-grid [data]="gridViewTemp" [resizable]="true" class="grid-ui upload-grid" [sortable]="true"
                  [resizable]="true">

                  <kendo-grid-column field="stoneId" title="StoneId" [width]="110">
                  </kendo-grid-column>
                  <kendo-grid-column field="tempPrice.rap" title="Rap" [width]="120">
                  </kendo-grid-column>
                  <kendo-grid-column field="tempPrice.discount" title="Discount" [width]="100">
                  </kendo-grid-column>
                  <kendo-grid-column field="tempPrice.perCarat" title="perCarat" [width]="110">
                  </kendo-grid-column>
                  <kendo-grid-column field="tempPrice.netAmount" title="NetAmount" [width]="120">
                  </kendo-grid-column>
                  <kendo-grid-column field="updatedAt" title="Date" [width]="150">
                    <ng-template kendoGridCellTemplate let-dataItem>
                      {{dataItem.updatedAt | date: 'dd-MM-yyyy hh:mm:ss a'}}
                    </ng-template>
                  </kendo-grid-column>
                </kendo-grid>
              </div>
            </div>
            <!-- #endregion -->
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<!-- Temp Discount Dialog End-->

<div kendoDialogContainer></div>